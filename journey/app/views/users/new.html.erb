<h1>Create your account</h1>

<% if @user.errors.any? %>
  <div style="color:#b00">
    <p><strong>Could not create account:</strong></p>
    <ul>
      <% @user.errors.full_messages.each do |m| %><li><%= m %></li><% end %>
    </ul>
  </div>
<% end %>

<%= form_with model: @user, url: users_path, method: :post, data: { turbo: false } do |f| %>
  <!-- Required fields -->
  <p>
    <%= f.label :email %><br>
    <%= f.email_field :email, required: true, autocomplete: "username" %>
  </p>

  <p>
    <%= f.label :name %><br>
    <%= f.text_field :name, required: true, autocomplete: "name" %>
  </p>

  <p>
    <%= f.label :password %><br>
    <%= f.password_field :password, required: true, autocomplete: "new-password" %>
  </p>

  <p>
    <%= f.label :password_confirmation, "Repeat password" %><br>
    <%= f.password_field :password_confirmation, required: true, autocomplete: "new-password" %>
  </p>

    <%= f.fields_for :profile do |p| %>
    <fieldset style="border:0; padding:0; margin-top:1rem">
        <legend style="font-weight:600">Optional</legend>

        <div class="field">
        <span class="label">Phone</span>
        <div class="phone-row">
            <%= p.select :phone_country_code,
            options_for_select([
                ['ðŸ‡¨ðŸ‡­ +41 Switzerland', '41'],
                ['ðŸ‡©ðŸ‡ª +49 Germany',     '49'],
                ['ðŸ‡¦ðŸ‡¹ +43 Austria',     '43'],
                ['â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€', '---'],
                ['ðŸ‡¬ðŸ‡§ +44 United Kingdom', '44'],
                ['ðŸ‡ºðŸ‡¸ +1 United States',   '1'],
                ['ðŸ‡¯ðŸ‡µ +81 Japan',          '81'],
                ['ðŸ‡¦ðŸ‡º +61 Australia',      '61']
            ], selected: p.object&.phone_country_code || '41'),
            {}, class: "phone-dial" %>

            <%= p.telephone_field :phone_local,
                placeholder: "79 123 45 67",
                inputmode: "tel",
                pattern: "^[0-9][0-9\\s\\-]{5,17}$",
                class: "phone-number" %>
        </div>
        <%= p.hidden_field :phone %> 
        </div>

        <p>
        <%= p.label :bday, "Date of birth" %><br>
        <%= p.date_field :bday %>
        </p>

        <p>
        <%= p.label :country %><br>
        <%= p.text_field :country, placeholder: "CH" %>
        </p>

        <p>
        <%= p.label :hq, "Headquarters" %><br>
        <%= p.text_field :hq, placeholder: "ZÃ¼rich" %>
        </p>
    </fieldset>
    <% end %>
  <p><%= f.submit "Sign Up" %></p>
<% end %>